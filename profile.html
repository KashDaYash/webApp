<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no"/>
  <title>WebApp</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lottie-web/5.10.2/lottie.min.js"></script>
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">
  <link rel="stylesheet" href="profile.css"/>
</head>
<body>

  <div id="loadingScreen">
    <div class="progress-wrapper"><div id="progressBar" class="progress-bar"></div></div>
  </div>

  <main id="app">
    
    <section id="tab-profile" class="page active-page">
      <div class="profile-card">
        <button id="themeToggle" class="theme-btn-float" onclick="toggleTheme()">
          <span class="material-icons-round">dark_mode</span>
        </button>

        <div class="avatar-wrapper">
          <div id="lottie" class="lottie-glow"></div>
          <img id="userAvatar" class="avatar" src=""/>
        </div>

        <h2 id="userName">Loading...</h2>
        
        <div class="stats-row">
           <div class="stat-item">
             <span class="stat-val" id="friendsCount">0</span>
             <span class="stat-label">Chats</span>
           </div>
           <div class="stat-item">
             <span class="stat-val" id="userLanguage">EN</span>
             <span class="stat-label">Lang</span>
           </div>
        </div>

        <div class="profile-body">
           <div class="info-box copyable">
             <span class="material-icons-round icon">fingerprint</span>
             <span id="userId" class="text-val">...</span>
           </div>
           <div class="info-box copyable">
             <span class="material-icons-round icon">alternate_email</span>
             <span id="userHandle" class="text-val">...</span>
           </div>
        </div>
      </div>
    </section>

    <section id="tab-chat" class="page">
      <div class="page-header"><h2>Messages</h2></div>
      
      <div class="search-sticky">
        <div class="search-input-wrapper">
          <span class="material-icons-round">search</span>
          <input type="text" id="userSearch" placeholder="Search users..." autocomplete="off">
        </div>
      </div>

      <div id="suggestionList" class="user-list"></div>
      <div id="recentChatsList" class="user-list"></div>
      
      <div id="emptyChatState" class="empty-state hidden">
        <span class="material-icons-round">forum</span>
        <p>No chats yet</p>
      </div>
    </section>

    <section id="tab-notif" class="page">
      <div class="page-header"><h2>Notifications</h2></div>
      <div class="empty-state" style="margin-top: 50px;">
        <span class="material-icons-round" style="font-size: 4rem; opacity: 0.2;">notifications_none</span>
        <p style="opacity: 0.6;">No new notifications</p>
      </div>
    </section>

    <section id="tab-settings" class="page">
      <div class="page-header"><h2>Settings</h2></div>
      <div class="menu-list">
        <div class="menu-row" onclick="toggleTheme()">
          <div class="row-left"><span class="material-icons-round">palette</span> Appearance</div>
        </div>
        <div class="menu-row danger" onclick="Telegram.WebApp.close()">
           <div class="row-left"><span class="material-icons-round">logout</span> Close App</div>
        </div>
      </div>
    </section>

  </main>

  <nav class="bottom-nav">
    <div class="nav-item active" onclick="switchTab('tab-profile', this)">
      <span class="material-icons-round">person</span>
    </div>
    <div class="nav-item" onclick="switchTab('tab-chat', this)">
      <span class="material-icons-round">chat_bubble</span>
    </div>
    <div class="nav-item" onclick="switchTab('tab-notif', this)">
      <span class="material-icons-round">notifications</span>
    </div>
    <div class="nav-item" onclick="switchTab('tab-settings', this)">
      <span class="material-icons-round">settings</span>
    </div>
  </nav>

  <div id="chatRoom" class="chat-room-overlay">
    <div class="chat-room-header">
      <button class="back-btn" onclick="closeChatRoom()">
        <span class="material-icons-round">arrow_back_ios</span>
      </button>
      <img id="chatPartnerImg" src="" class="header-avatar">
      <div class="header-info">
        <h3 id="chatPartnerName">User</h3>
        <span class="status">Online</span>
      </div>
    </div>

    <div id="messageArea" class="messages-container"></div>

    <div class="chat-input-bar">
      <input type="text" id="msgInput" placeholder="Message..." autocomplete="off" onkeypress="if(event.key === 'Enter') sendMsg()">
      <button id="sendBtn" class="send-fab" onclick="sendMsg()">
        <span class="material-icons-round">send</span>
      </button>
    </div>
  </div>

  <script src="profile.js"></script>
</body>
</html>
